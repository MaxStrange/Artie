name: artie-api-server
labels:
  - docker-image
dependencies:
  - artie-base-image: docker-image
artifacts:
  - name: docker-image
    type: docker-image
type: build
steps:
  - job: docker-build
    artifacts:
      - docker-image
    img-base-name: artie-api-server
    buildx: true
    platforms:
      - linux/arm64
      - linux/amd64
    dockerfile-dpath: "${REPO_ROOT}/misc-micro-services/artie-api-server"
    dockerfile: Dockerfile
    build-context: "."
    build-args:
      - GIT_TAG: ${GIT_TAG}
      - ARTIE_BASE_IMG:
          dependency:
            name: docker-image
            producing-task: artie-base-image
      - SERVE_ON_PORT: 8782
